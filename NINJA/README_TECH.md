# README_TECH.md (NINJA)

## 0. プロジェクト概要と操作説明

本ドキュメントは、回避を主軸とした3Dアクションゲーム『NINJA』の**技術的な詳細と、私の担当範囲における設計意図**を解説します。

| 項目 | 説明 |
| :--- | :--- |
| **ゲーム概要** | 回避を主軸にしたプレイヤーとボスの3Dアクションゲーム。敵とプレイヤーの距離に応じた行動分岐（ビヘイビア）を設計。 |
| **クリア条件** | 各ボスの撃破。 |
| **担当コードの場所** | ルートフォルダ内 `/NINJA/Assets/Script/Enemy_Yuki/` 以下に、ボスの行動ロジック（ビヘイビア、距離判定）が含まれます。 |
| **特に見てほしいコード** | **`EnemySensor.cs`**（距離判定を利用したボスの行動分岐ロジックの核となる部分）。 |

### 基本操作（Xboxコントローラー）

| 操作 | ボタン | 説明 |
| :--- | :--- | :--- |
| **移動** | Lスティック | プレイヤーの移動 |
| **視点操作** | Rスティック | カメラの視点操作 |
| **回避/ダッシュ** | X | プレイヤーの回避行動 |
| **通常攻撃** | R攻撃 (R1/RB) | プレイヤーの通常攻撃 |

---

## 1. プロジェクト目的と設計思想

### 1-1. 敵の行動ロジック設計（ビヘイビア）

本プロジェクトの主要目的は、プレイヤーとの距離に応じてボスの行動が動的に変化する、**戦術的で説得力のある行動分岐システム**を構築することでした。

単調な攻撃パターンではなく、以下のような明確な戦術的意図を持たせることで、プレイヤーに「回避」を主軸とした緊張感のあるゲーム体験を提供することを目指しました。

* **遠距離戦術:** プレイヤーが遠くにいる場合は、**安易な接近を許さないための牽制攻撃や飛び道具**を行い、戦闘の間合いを管理します。
* **近距離戦術:** プレイヤーが接近しすぎた場合は、そのまま殴り合うのではなく、**距離を突き放すための特殊な攻撃やステップ**を行い、ボスの得意な中距離での戦闘を維持するように設計しました。

**この設計により、ボスは常に最適な間合いを維持しようと行動し、プレイヤーに戦略的な立ち回りを要求するAIを実現しました。**

---

## 2. 開発における課題と解決プロセス

### 2-1. 距離による行動分岐の正確な実装とパフォーマンス意識

最も注力し、今後の改善点を見つけた課題は、**「距離に応じて行動を変える」**AIのロジック実装と、そのパフォーマンスに対する意識です。

#### 課題と直面した問題

ボスの行動決定ロジックの中で、敵とプレイヤーの距離を頻繁に計測し、その結果に基づき行動を切り替える必要がありました。この**距離計測の精度と効率**をどのように両立させるかが課題でした。

#### 解決プロセスと今後の改善点

1.  **初期実装と解決:** プレイヤーと敵の距離計測には、**`Vector3.Distance(a, b)`** 関数を利用して実装しました。これにより、意図通りに距離に応じた行動分岐を実現し、ボスのビヘイビアを完成させました。
2.  **パフォーマンス意識と改善意図:**
    `Vector3.Distance()` は内部的に**平方根（`Mathf.Sqrt`）の計算**を伴うため、毎フレーム実行されるAIロジックで多用すると処理負荷が高まる可能性があります。
    * このため、今後は、平方根の計算をスキップできる**`Vector3.sqrMagnitude`** プロパティを使用し、距離の**二乗**を比較する形にリファクタリングする計画です。
    * この改善により、コードの正確な動作を維持しつつ、**処理速度を向上させた、パフォーマンス効率の高い距離判定**を目指します。

**この経験を通じて、単に機能を実現するだけでなく、Unity APIの特性を理解し、パフォーマンスを意識したコードの書き方を学ぶことができました。**

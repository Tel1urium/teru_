# README_TECH.md (PigSAhotArena)

## 0. プロジェクト概要と操作説明

本ドキュメントは、物理挙動のカオスを楽しむ3D対戦プロトタイプ『PigSAhotArena』の**技術的な詳細と、私の担当範囲における設計意図**を解説します。

| 項目 | 説明 |
| :--- | :--- |
| **ゲーム概要** | 跳ねて転がる物理挙動を核とした**ローカルマルチ**対応の3D対戦ゲームプロトタイプ。反射の物理挙動に注力。 |
| **勝利条件** | 対戦相手をフィールド中央の穴に入れる。 |
| **担当コードの場所** | ルートフォルダ内 `/PigSAhotArena/Assets/Teru/script/` 以下。 |
| **特に見てほしいコード** | **`Player.cs`** 内の **`CollisionPredictionAndReflect()` 関数**（反射挙動の計算と衝突安定化ロジック）。 |

### 基本操作（Xboxコントローラー）

| 操作 | ボタン | 説明 |
| :--- | :--- | :--- |
| **移動** | Lスティック | キャラクターの移動 |
| **チャージ** | Rトリガー 長押し | 攻撃（飛ばす動作）のパワーを溜める |
| **飛ばす** | Rトリガー 離す | 溜めたパワーでボールまたは相手を飛ばす攻撃を発動 |

---

## 1. プロジェクト目的と設計思想

### 1-1. 物理挙動の安定化とゲーム性への応用

本プロジェクトの主要な目的は、Unityの物理シミュレーションを核としながら、**「跳ねて転がるカオス」というゲーム性を実現するために、反射の挙動を意図的に制御・安定化させること**でした。

これは、不安定になりがちな物理挙動を、**ゲームのルールとして許容できる、面白さに繋がる範囲に制御する**ための技術的な挑戦でした。

---

## 2. 開発における課題と解決プロセス

### 2-1. Unity既存の物理エンジンでは再現できなかった反射の挙動への対応

最も注力し、成果を上げた課題は、**標準の物理エンジンだけでは実現できなかった、特殊な反射挙動の再現と、衝突時の安定性**でした。

#### 課題と直面した問題

ゲーム性が要求する特定の反射の強さや角度は、**Unityの `Rigidbody` や Physics Materialの設定だけでは正確に再現できませんでした。**特に、高速でオブジェクトが衝突した際に、**物理計算のスキップによりオブジェクトが壁を無視して通り抜けてしまう（トンネリング現象）**問題が発生しました。

#### 解決プロセスとアピールポイント

この問題への対策は、主に**`Player.cs` 内の `CollisionPredictionAndReflect()` 関数**に集約されています。

1.  **オブジェクトの通り抜け防止（Raycastによるトンネリング対策）:**
    高速移動時の衝突計算の漏れを防ぐため、移動経路に対し**Raycast**を使用するロジックを実装しました。これにより、**オブジェクトが壁などを無視して通り抜ける致命的なバグを解消**し、衝突判定の信頼性を大幅に向上させました。
2.  **反射挙動の手動計算と制御:**
    Unityの標準機能に頼るだけでなく、Raycastで取得した衝突情報に基づき、**反射挙動を独自に計算し、`Rigidbody` の速度を直接操作することで上書き・微調整**するロジックを実装しました。これにより、**ゲームデザインが求めるユニークな反射**を実現し、ゲーム性を高めることができました。
3.  **実行タイミングの厳格化:**
    これらのロジックは、フレームレートに影響されない安定したシミュレーションを行うため、**`FixedUpdate()`** のタイミングで実行されています。

**この経験を通じて、Unityの既存機能の限界を理解し、低レベルの物理API（`Raycast`や`AddForce`など）を組み合わせて、意図通りの挙動を作り出す**高度な問題解決能力**を培うことができました。**

---

## 3. 今後の展望（仕様変更の可能性について）

* **現状:** 本プロジェクトは**ローカルマルチ**プレイに特化して設計されています。
* **今後の展望と仕様変更の可能性:** 将来的な**ネットワークマルチプレイ対応**を計画しており、その際には、現在の物理処理に大きく依存したコード設計を、ネットワーク同期に適した形に**大幅に変更（リファクタリング）**する可能性があります。
* **評価のお願い:** この点は、現在のコードレビューにおいてご留意いただき、**「ローカルマルチプレイのプロトタイプ」**としての物理挙動制御に注力した点をご評価いただけますと幸いです。
